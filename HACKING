-*- outline -*-

This file attempts to describe the rules to use when hacking Bison.
Don't put this file into the distribution.

Everything related to the development of Bison is on Savannah:

	http://savannah.gnu.org/projects/bison/


* Administrivia

** If you incorporate a change from somebody on the net:
First, if it is a large change, you must make sure they have signed
the appropriate paperwork.  Second, be sure to add their name and
email address to THANKS.

** If a change fixes a test, mention the test in the ChangeLog entry.

** Bug reports
If somebody reports a new bug, mention his name in the ChangeLog entry
and in the test case you write.  Put him into THANKS.

The correct response to most actual bugs is to write a new test case
which demonstrates the bug.  Then fix the bug, re-run the test suite,
and check everything in.

** You may find it useful to install the git-merge-changelog merge driver.
See http://www.mail-archive.com/bug-gnulib@gnu.org/msg09699.html for
information on how to install it.


* Hacking

** Visible changes
Which include serious bug fixes, must be mentioned in NEWS.

** Translations
Only user visible strings are to be translated: error messages, bits
of the .output file etc.  This excludes impossible error messages
(comparable to assert/abort), and all the --trace output which is
meant for the maintainers only.


* Test suite

** make check
Use liberally.

** Release checks
Try to run the test suite with more severe conditions before a
release:

- Configure the package with --enable-gcc-warnings, so that one checks
  that 1. Bison compiles cleanly, 2. the parsers it produces compile
  cleanly too.

- run `make maintainer-check' which:
  - runs `valgrind -q bison' to run Bison under Valgrind.
  - runs the parsers under Valgrind.
  - runs the test suite with G++ as C compiler...

- run `make maintainer-push-check', which runs `make maintainer-check'
  while activating the push implementation and its pull interface wrappers
  in many test cases that were originally written to exercise only the
  pull implementation.  This makes certain the push implementation can
  perform every task the pull implementation can.

- run `make maintainer-xml-check', which runs `make maintainer-check'
  while checking Bison's XML automaton report for every working grammar
  passed to Bison in the test suite.  The check just diffs the output of
  Bison's included XSLT style sheets with the output of --report=all and
  --graph.

- Change tests/atlocal/CFLAGS to add your preferred options.  For
  instance, `-traditional' to check that the parsers are K&R.  Note
  that it does not make sense for glr.c, which should be ANSI,
  but currently is actually GNU C, nor for lalr1.cc, which anyway is
  not exercised yet in the test suite.


* Release Procedure

** Try to get the *.pot files to the Translation Project at least one week
before a stable release, to give them time to translate them.

** Tests
See above.

** Update the foreign files
Running `./bootstrap' in the top level should update them all for you.
This covers PO files too.  Sometimes a PO file contains problems that
causes it to be rejected by recent Gettext releases; please report
these to the Translation Project.

** Update NEWS
The version number, *and* the date of the release (including for
betas).

** Update ChangeLog
Should have an entry similar to `Version 1.49b.'.
Check all this in once `make distcheck' passes.

** make alpha
Running `make alpha' is absolutely perfect for beta releases: it makes
the tarballs, the xdeltas, and prepares (in /tmp/) a proto
announcement.  It is so neat, that that's what I use anyway for
genuine releases, but adjusting things by hand (e.g., the urls in the
announcement file, the ChangeLog which is not needed etc.).
FIXME: `make alpha' is not maintained and is broken.  These
instructions need to be replaced or removed.

If it fails, you're on your own...

It requires GNU Make.

** Upload
Put the tarballs/xdeltas where they should be.  Or put it somewhere,
and send the URL to ftp-upload@gnu.org.

** Bump the version number
In configure.ac.  Run `make', check this in.

** Announce
Complete/fix the announcement file, and send it at least to
info-gnu@gnu.org (if a real release, or a ``serious beta''),
bug-bison@gnu.org, help-bison@gnu.org, bison-patches@gnu.org,
and coordinator@translationproject.org.

Send the same announcement on the comp.compilers newsgroup by sending
email to compilers@iecc.com.  Do not make any Cc as the moderator will
throw away anything cross-posted or Cc'ed.  It really needs to be a
separate message.


-----

Copyright (C) 2002, 2003, 2004, 2005, 2007, 2008 Free Software Foundation, Inc.

This file is part of GNU Bison.

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
